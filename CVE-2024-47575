The observed attacks show that the threat actors register attacker-controlled FortiGate devices under the name "localhost".

Log entries

type=event,subtype=dvm,pri=information,desc="Device,manager,generic,information,log",user="device,...",msg="Unregistered device localhost add succeeded" device="localhost" adom="FortiManager" session_id=0 operation="Add device" performed_on="localhost" changes="Unregistered device localhost add succeeded"


type=event,subtype=dvm,pri=notice,desc="Device,Manager,dvm,log,at,notice,level",user="System",userfrom="",msg="" adom="root" session_id=0 operation="Modify device" performed_on="localhost" changes="Edited device settings (SN FMG-VMTM23017412)"


**Important note**: The two entries above may keep being logged even on an up-to-date, patched system (eg: FMG 7.4.5) - in which case they are not Indicators of Compromise anymore, but rather indicators of a (failed) attempt to compromise the system. Indeed, the fix is not meant to prevent adding unauthorized devices (which these log entries are indicative of, and which can legitimately happen in a deployment context), it is meant to prevent unauthorized devices to send exploit commands.


IP addresses

45.32.41.202
104.238.141.143
158.247.199.37
45.32.63.2
80.66.196.199
104.238.141.143
158.247.199.37
195.85.114.78 (Not observed by Fortinet, reported by Mandiant here)
172.232.167.68 (Not observed by Fortinet, reported by trusted third party)


Serial Number

FMG-VMTM23017412
FMG-VMTM19008093


Files

/tmp/.tm
/var/tmp/.tm

*Note that file IoCs may not appear in all cases.*

